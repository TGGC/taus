GLOBAL {
  STARTADDR $8000;
};

SEGMENT { START $8000; END $FFF9; NAME "PRG"; };
SEGMENT { START $FFFA; END $FFFF; NAME "VECTORS"; };

# Hack around broken disassembly. They are probably data anyway.
RANGE { START $939B; END $93AA; TYPE BYTETABLE; };
RANGE { START $A180; END $A180; TYPE BYTETABLE; };
RANGE { START $B24C; END $B24C; TYPE BYTETABLE; };

# Variables
# Note that this causes literal zeros, like for lda $0,x to incorrectly
# reference tmp (see generateNextPseudorandomNumber)
LABEL { ADDR $0000; NAME "tmp1"; }; # noncanon
LABEL { ADDR $0001; NAME "tmp2"; }; # noncanon
LABEL { ADDR $0002; NAME "tmp3"; }; # noncanon
LABEL { ADDR $0017; NAME "rng_seed"; SIZE 2; }; # noncanon
LABEL { ADDR $0019; NAME "spawnID"; };
LABEL { ADDR $001A; NAME "spawnCount"; };
LABEL { ADDR $0033; NAME "verticalBlankingInterval"; };
LABEL { ADDR $0040; NAME "tetriminoX"; };
LABEL { ADDR $0041; NAME "tetriminoY"; };
LABEL { ADDR $0044; NAME "levelNumber"; };
LABEL { ADDR $0045; NAME "fallTimer"; };
LABEL { ADDR $0046; NAME "autorepeatX"; };
LABEL { ADDR $0048; NAME "playState"; };
LABEL { ADDR $0049; NAME "vramRow"; };
LABEL { ADDR $004E; NAME "autorepeatY"; };
LABEL { ADDR $004F; NAME "holdDownPoints"; };
LABEL { ADDR $0050; NAME "lines"; SIZE 2; }; # noncanon
LABEL { ADDR $0052; NAME "rowY"; };
LABEL { ADDR $0053; NAME "score"; SIZE 3; };
LABEL { ADDR $0056; NAME "completedLines"; };
LABEL { ADDR $0058; NAME "curtainRow"; };
# $60-$7F is a mirror of $40-$5F
LABEL { ADDR $0060; NAME "tetriminoX_mirror"; }; # noncanon
LABEL { ADDR $0061; NAME "tetriminoY_mirror"; }; # noncanon
LABEL { ADDR $0064; NAME "levelNumber_mirror"; }; # noncanon
LABEL { ADDR $0065; NAME "fallTimer_mirror"; }; # noncanon
LABEL { ADDR $0066; NAME "autorepeatX_mirror"; }; # noncanon
LABEL { ADDR $0068; NAME "playState_mirror"; }; # noncanon
LABEL { ADDR $0069; NAME "vramRow_mirror"; }; # noncanon
LABEL { ADDR $006E; NAME "autorepeatY_mirror"; }; # noncanon
LABEL { ADDR $006F; NAME "holdDownPoints_mirror"; }; # noncanon
LABEL { ADDR $0070; NAME "lines_mirror"; SIZE 2; }; # noncanon
LABEL { ADDR $0072; NAME "rowY_mirror"; }; # noncanon
LABEL { ADDR $0073; NAME "score_mirror"; SIZE 3; }; # noncanon
LABEL { ADDR $0076; NAME "completedLines_mirror"; }; # noncanon
LABEL { ADDR $0078; NAME "curtainRow_mirror"; }; # noncanon
LABEL { ADDR $00A8; NAME "legalScreenCounter2"; };
LABEL { ADDR $00AE; NAME "originalY"; };
LABEL { ADDR $00AF; NAME "dropSpeed"; };
LABEL { ADDR $00B1; NAME "frameCounter"; };
LABEL { ADDR $00B5; NAME "newlyPressedButtons_mirror"; }; # noncanon
LABEL { ADDR $00B6; NAME "pressedButtons_mirror"; }; # noncanon
LABEL { ADDR $00B9; NAME "leftPlayfield"; };
LABEL { ADDR $00BC; NAME "totalGarbage"; };
LABEL { ADDR $00BD; NAME "renderMode"; };
LABEL { ADDR $00C0; NAME "gameMode"; };
LABEL { ADDR $00C3; NAME "legalScreenCounter1"; };
LABEL { ADDR $00C4; NAME "ending"; };
LABEL { ADDR $00CE; NAME "heldButtons"; };
LABEL { ADDR $00CF; NAME "repeats"; };
LABEL { ADDR $00D1; NAME "demoButtonsTable_index"; }; # noncanon
LABEL { ADDR $00D2; NAME "demoButtonsTable_indexOverflowed"; }; # noncanon
LABEL { ADDR $00D3; NAME "demoIndex"; };
LABEL { ADDR $00F5; NAME "newlyPressedButtons"; }; # noncanon
LABEL { ADDR $00F6; NAME "pressedButtons"; }; # noncanon
LABEL { ADDR $00F7; NAME "getHeldButtons"; };
LABEL { ADDR $0100; NAME "stack"; SIZE $FF; }; # noncanon
# OAM format: https://wiki.nesdev.com/w/index.php/PPU_programmer_reference#OAM
LABEL { ADDR $0200; NAME "oamStaging"; SIZE $100; }; # noncanon
LABEL { ADDR $03F0; NAME "statsByType"; SIZE 14; }; # noncanon
LABEL { ADDR $0400; NAME "playfield"; };

LABEL { ADDR $2000; NAME "PPUCTRL"; };
LABEL { ADDR $2001; NAME "PPUMASK"; };
LABEL { ADDR $2002; NAME "PPUSTATUS"; };
LABEL { ADDR $2003; NAME "OAMADDR"; };
LABEL { ADDR $2004; NAME "OAMDATA"; };
LABEL { ADDR $2005; NAME "PPUSCROLL"; };
LABEL { ADDR $2006; NAME "PPUADDR"; };
LABEL { ADDR $2007; NAME "PPUDATA"; };
LABEL { ADDR $4014; NAME "OAMDMA"; };

# Code and tables
RANGE { START $8050; END $8059; TYPE ADDRTABLE; }; # switch (renderMode)
RANGE { START $8166; END $8171; TYPE ADDRTABLE; }; # switch (gameMode)
RANGE { START $81B7; END $81CE; TYPE ADDRTABLE; }; # switch (playState)
RANGE { START $81DE; END $81F5; TYPE ADDRTABLE; }; # switch (playState)
RANGE { START $88EE; END $8913; TYPE DBYTETABLE; NAME "rotationTable"; };
RANGE { START $898E; END $89AA; TYPE BYTETABLE; NAME "framesPerDropTable"; };
RANGE { START $8A9C; END $8B8B; TYPE BYTETABLE; NAME "orientationTable"; };
RANGE { START $96AA; END $96B7; TYPE DBYTETABLE; NAME "pieceToPpuStatAddr"; };
RANGE { START $96B8; END $96D5; TYPE BYTETABLE; NAME "levelDisplayTable"; }; # noncanon
RANGE { START $96D6; END $96E9; TYPE BYTETABLE; NAME "multBy10Table"; }; # noncanon
RANGE { START $984C; END $9873; TYPE DBYTETABLE; NAME "colorTable"; COMMENT "4 bytes per level (bg, fg, c3, c4)"; };
RANGE { START $993B; END $994D; TYPE BYTETABLE; NAME "tetriminoTypeFromOrientation"; }; # noncanon
RANGE { START $994E; END $9954; TYPE BYTETABLE; NAME "spawnTable"; };
RANGE { START $9956; END $9968; TYPE BYTETABLE; NAME "spawnOrientationFromOrientation"; }; # noncanon
RANGE { START $9CA5; END $9CAE; TYPE WORDTABLE; NAME "pointsTable"; };
RANGE { START $A4B6; END $A4C1; TYPE ADDRTABLE; }; # switch (ending)
RANGE { START $BF3C; END $C355; TYPE BYTETABLE; NAME "gameBackground"; }; # noncanon
RANGE { START $DF00; END $DF00; TYPE BYTETABLE; NAME "demoTetriminoTypeTable"; COMMENT "unknown size"; };
RANGE { START $FFFA; END $FFFF; TYPE ADDRTABLE; }; # interrupts

LABEL { ADDR $8005; NAME "nmi"; }; # noncanon
LABEL { ADDR $804A; NAME "irq"; }; # noncanon
LABEL { ADDR $804B; NAME "render"; };
LABEL { ADDR $8138; NAME "mainLoop"; }; # noncanon
LABEL { ADDR $8142; NAME "notWaitingForVBlank"; }; # noncanon
LABEL { ADDR $815D; NAME "game_mode_play_high_score_screen_ending_pause_demo"; }; # noncanon
LABEL { ADDR $8161; NAME "branchOnGameMode"; };
LABEL { ADDR $8200; NAME "game_mode_legal_screen"; }; # noncanon
LABEL { ADDR $824F; NAME "game_mode_title_screen"; }; # noncanon
LABEL { ADDR $82B1; NAME "render_mode_legal_and_title_screens"; }; # noncanon
LABEL { ADDR $82D1; NAME "game_mode_game_type_menu"; }; # noncanon
LABEL { ADDR $83D7; NAME "game_mode_level_and_height_menu"; }; # noncanon
LABEL { ADDR $85DA; NAME "render_mode_menu_screens"; }; # noncanon
LABEL { ADDR $86E9; NAME "in_the_middle_of_reset_for_start_game"; }; # noncanon
LABEL { ADDR $88AB; NAME "rotate_tetrimino"; }; # noncanon
LABEL { ADDR $88CF; NAME "aNotPressed"; };
LABEL { ADDR $88E9; NAME "restoreOrientationID"; };
LABEL { ADDR $8914; NAME "drop_tetrimino"; }; # noncanon
LABEL { ADDR $8924; NAME "playing"; };
LABEL { ADDR $8939; NAME "autorepeating"; };
LABEL { ADDR $894A; NAME "downPressed"; };
LABEL { ADDR $8958; NAME "drop"; };
LABEL { ADDR $8973; NAME "lookupDropSpeed"; };
LABEL { ADDR $897E; NAME "noTableLookup"; };
LABEL { ADDR $8989; NAME "incrementAutorepeatY"; };
LABEL { ADDR $89AE; NAME "shift_tetrimino"; }; # noncanon
LABEL { ADDR $89D3; NAME "resetAutorepeatX"; };
LABEL { ADDR $89D7; NAME "buttonHeldDown"; };
LABEL { ADDR $89EC; NAME "notPressingRight"; };
LABEL { ADDR $8A01; NAME "restoreX"; };
LABEL { ADDR $948B; NAME "is_position_valid"; };
LABEL { ADDR $94EE; NAME "render_mode_play_and_demo"; }; # noncanon
LABEL { ADDR $95B5; NAME "render_play_digits"; }; # noncanon
LABEL { ADDR $9712; NAME "twoDigsToPPU"; }; # noncanon
LABEL { ADDR $9725; NAME "copyPlayfieldRowToVRAM"; };
LABEL { ADDR $977F; NAME "updateLineClearingAnimation"; };
LABEL { ADDR $97A6; NAME "twoPlayers"; };
LABEL { ADDR $97BD; NAME "updateVRAM"; };
LABEL { ADDR $9903; NAME "pickRandomTetrimino"; };
LABEL { ADDR $991C; NAME "invalidIndex"; };
LABEL { ADDR $9938; NAME "useNewSpawnID"; };
LABEL { ADDR $9969; NAME "incrementPieceStat"; }; # noncanon
LABEL { ADDR $99B8; NAME "updatePlayfield_jmp"; }; # noncanon
LABEL { ADDR $9A2D; NAME "drawCurtainRow"; };
LABEL { ADDR $9A3E; NAME "incrementCurtainRow"; };
LABEL { ADDR $9A47; NAME "endGame"; };
LABEL { ADDR $9A4D; NAME "check_for_ending_animation"; }; # noncanon
LABEL { ADDR $9A64; NAME "select_ending"; }; # noncanon
LABEL { ADDR $9ACC; NAME "rowNotComplete"; };
LABEL { ADDR $9AD2; NAME "incrementLineIndex"; };
LABEL { ADDR $9B53; NAME "garbageLines"; };
LABEL { ADDR $9BA8; NAME "incrementLines"; }; # noncanon
LABEL { ADDR $9CAF; NAME "updatePlayfield"; };
LABEL { ADDR $9D51; NAME "pollControllerButtons"; };
LABEL { ADDR $9D73; NAME "finishedMove"; };
LABEL { ADDR $9D9A; NAME "moveInProgress"; };
LABEL { ADDR $9D9E; NAME "holdButtons"; };
LABEL { ADDR $9DA3; NAME "startButtonPressed"; };
LABEL { ADDR $9DB0; NAME "recording"; };
LABEL { ADDR $9DE4; NAME "buttonsNotChanged"; };
LABEL { ADDR $9DE8; NAME "demoButtonsTable_indexIncr"; }; # noncanon
LABEL { ADDR $9F95; NAME "render_mode_ending_animation"; }; # noncanon
LABEL { ADDR $9FFF; NAME "MMC1_Control"; }; # noncanon
LABEL { ADDR $A344; NAME "render_mode_congratulations_screen"; }; # noncanon
LABEL { ADDR $A459; NAME "sleep_for_legalScreenCounter1_vblanks"; }; # noncanon
LABEL { ADDR $A507; NAME "ending_over_120k"; }; # noncanon
LABEL { ADDR $A9A5; NAME "ending_selected"; }; # noncanon
LABEL { ADDR $AA2F; NAME "waitForVerticalBlankingInterval"; };
LABEL { ADDR $AA45; NAME "updateAudioAndWaitForVerticalBlankingInterval"; }; # noncanon
LABEL { ADDR $AA52; NAME "setPPUColorControl"; }; # noncanon
LABEL { ADDR $AB47; NAME "generateNextPseudorandomNumber"; };
LABEL { ADDR $AB5E; NAME "initializeOAM"; };
LABEL { ADDR $AB9D; NAME "pollController"; };
LABEL { ADDR $AC1C; NAME "memset_ppu_page_and_more"; }; # noncanon
LABEL { ADDR $AC6A; NAME "memset_page"; }; # noncanon
LABEL { ADDR $AC82; NAME "switch_s_plus_2a"; }; # noncanon
LABEL { ADDR $ACA3; NAME "setMMC1Control"; }; # noncanon
LABEL { ADDR $ACB7; NAME "changeCHRBank0"; }; # noncanon
LABEL { ADDR $ACCB; NAME "changeCHRBank1"; }; # noncanon
LABEL { ADDR $ACDF; NAME "changePRGBank"; }; # noncanon
LABEL { ADDR $BFFF; NAME "MMC1_CHR0"; }; # noncanon
LABEL { ADDR $DFFF; NAME "MMC1_CHR1"; }; # noncanon
LABEL { ADDR $E000; NAME "updateAudio"; };
LABEL { ADDR $E003; NAME "updateAudio2"; }; # noncanon
LABEL { ADDR $FF00; NAME "reset"; }; # noncanon
LABEL { ADDR $FFF0; NAME "MMC1_PRG"; }; # noncanon
